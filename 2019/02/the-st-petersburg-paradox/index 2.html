<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>The St. Petersburg Paradox and Utility Function · Rongjia Liu</title><meta name="description" content="The St. Petersburg Paradox and Utility Function - Rongjia Liu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/arctic.css"><link rel="search" type="application/opensearchdescription+xml" href="http://jackliu234.com/atom.xml" title="Rongjia Liu"><script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/search/" target="_self" class="nav-list-link">SEARCH</a></li><!-- li.nav-list-item--><!--    a.nav-list-link(class="search" href=url_for("search") target="_self") <i class="fa fa-search" aria-hidden="true"></i>--></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">The St. Petersburg Paradox and Utility Function</h1><div class="post-info"><span>&#128197; &nbsp;</span>Feb 15, 2019<span id="busuanzi_container_page_pv">| &#128065;</span><span id="busuanzi_value_page_pv"></span><!--    if item.tags--><!--        span | &nbsp;--><!--        for tag in item.tags.toArray()--><!--            a(href=url_for(tag.path))=  '#' + tag.name--><!-- if item.from && (is_home() || is_post())--><!--    a.post-from(href=item.from target="_blank" title=item.from)!= __('translated')-->
</div><div class="post-content"><a id="more"></a>
<h1 id="The-Paradox"><a href="#The-Paradox" class="headerlink" title="The Paradox"></a>The Paradox</h1><p>The <code>St. Petersburg paradox</code> describes a game of chance for a single player in which a fair coin is tossed at each stage. The initial stake starts at 2 dollars and is doubled every time heads appears. The first time tails appears, the game ends and the player wins whatever is in the pot.</p>
<p>Let <script type="math/tex">X_n</script> denote the final winning amount after the <script type="math/tex">n</script>th toss. We know that <script type="math/tex">X_0 = 2</script> and <script type="math/tex">P(X_n = 2X_{n-1})=1/2</script> and <script type="math/tex">P(X_n = X_{n-1})=1/2</script>. We can see that <script type="math/tex">X_{n}</script> is a sub-martingale as <script type="math/tex">\mathbb{E}[X_{n}|\mathcal{F}_{n-1}] \geq X_{n-1}</script>.</p>
<p>Let <script type="math/tex">T</script> denote the minimum number of toss that shows a tail toss <script type="math/tex">T := min\{t: X_t=X_{t-1}\}</script>. <script type="math/tex">T</script> is a stopping time.</p>
<script type="math/tex; mode=display">\mathbb{E}X_{T} = \dfrac{1}{2} \times 2 + \dfrac{1}{4} \times 4 + \dfrac{1}{8} \times 8 + ... \rightarrow \infty</script><p>The variance:</p>
<script type="math/tex; mode=display">varX_{T} = \mathbb{E}X^2 - (\mathbb{E}X)^2 = \lim_{n\rightarrow \infty} 2^{n+1} - 2 - n^2 \rightarrow \infty</script><p>Considering nothing but the expected value of the net change in one’s monetary wealth, one should therefore play the game at any price if offered the opportunity. Yet the paradox exists between what people seem willing to pay to enter the game and the infinite expected value.</p>
<h1 id="The-Martingale"><a href="#The-Martingale" class="headerlink" title="The Martingale"></a>The Martingale</h1><p>With slight modifications from above, the <code>St. Petersburg martingale</code> is the sequence of random variable <script type="math/tex">X_n</script>, where <script type="math/tex">X_0=2</script> and <script type="math/tex">P(X_n=2X_{n-1}) = 1/2</script> and <script type="math/tex">P(X_n=0) = 1/2</script>. It is now a martingale because <script type="math/tex">\mathbb{E}(X_n|\mathcal{F}_{n-1}) = X_{n-1}</script>.</p>
<p>Note that now the expected payoff at inception is equal to initial stake based on Doob’s Idenfity, given stopping time T defined above: <script type="math/tex">\mathbb{E}X_{T} = X_{0}</script></p>
<h1 id="Expected-Utility-Theory"><a href="#Expected-Utility-Theory" class="headerlink" title="Expected Utility Theory"></a>Expected Utility Theory</h1><p>The classic way to resolve the paradox involves the introduction of utility function and the presumption of diminishing marginal utility.</p>
<p>Let <code>x</code> denote a person’s total wealth, then the logrithmic utility function states that:</p>
<script type="math/tex; mode=display">U(w) = \log{w}</script><p>Where the marginal utility is a decreasing function of x:</p>
<script type="math/tex; mode=display">\dfrac{dU^{log}(w)}{dw} = \dfrac{1}{w}</script><p>Now we calculate the maximum cost <code>c</code> that a person with logrithmic utility function and wealth <code>w</code> would pay to enter the game. The maximum cost will make the expected utility change from playing the game be 0.</p>
<script type="math/tex; mode=display">\Delta U(w) = 0 = \sum_{k=1}^{\infty} \dfrac{1}{2^k}[\log(w + 2^k - c) - \log(w)]</script><h1 id="Simulation"><a href="#Simulation" class="headerlink" title="Simulation"></a>Simulation</h1><p>Given <code>w</code>, <code>c</code> can be calculated numerically. In python, we first check the maximum power of two allowed in our simulation. It turns out to be 63:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = sys.maxsize</span><br><span class="line">print(<span class="string">'maximum integer: '</span>, x)</span><br><span class="line">max_power = np.log(x)/np.log(<span class="number">2</span>)</span><br><span class="line">print(<span class="string">'maximum power of 2: '</span>, max_power)</span><br></pre></td></tr></table></figure></p>
<p>Returns:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">maximum integer:  <span class="number">9223372036854775807</span></span><br><span class="line">maximum power of <span class="number">2</span>:  <span class="number">63.0</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Logrithmic-Utility-Function"><a href="#Logrithmic-Utility-Function" class="headerlink" title="Logrithmic Utility Function"></a>Logrithmic Utility Function</h2><p>Now we use fsolve to calculate the maximum <code>c</code> to break even:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> fsolve</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(c)</span>:</span></span><br><span class="line">    w = <span class="number">1000</span></span><br><span class="line">    p = <span class="number">0.5</span>`np.arange(<span class="number">1</span>, <span class="number">63</span>)</span><br><span class="line">    u = np.log(w + <span class="number">2</span>`np.arange(<span class="number">1</span>, <span class="number">63</span>) - c) - np.log(w)</span><br><span class="line">    <span class="keyword">return</span> sum(p*u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maximum_cost = fsolve(func, <span class="number">0</span>)</span><br><span class="line">print(<span class="string">"maximum cost to enter: "</span>, round(maximum_cost[<span class="number">0</span>], <span class="number">2</span>))</span><br></pre></td></tr></table></figure></p>
<p>When w = 1000:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maximum cost to enter:  <span class="number">10.95</span></span><br></pre></td></tr></table></figure></p>
<p>When w = 1000000:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maximum cost to enter:  <span class="number">20.87</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Square-Root-Utility-Function"><a href="#Square-Root-Utility-Function" class="headerlink" title="Square-Root Utility Function"></a>Square-Root Utility Function</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> fsolve</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(c)</span>:</span></span><br><span class="line">    w = <span class="number">1000</span></span><br><span class="line">    p = <span class="number">0.5</span>`np.arange(<span class="number">1</span>, <span class="number">63</span>)</span><br><span class="line">    u = np.sqrt(w + <span class="number">2</span>`np.arange(<span class="number">1</span>, <span class="number">63</span>) - c) - np.sqrt(w)</span><br><span class="line">    <span class="keyword">return</span> sum(p*u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">maximum_cost = fsolve(func, <span class="number">0</span>)</span><br><span class="line">print(<span class="string">"maximum cost to enter: "</span>, round(maximum_cost[<span class="number">0</span>], <span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>When w = 1000:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maximum cost to enter:  <span class="number">12.93</span></span><br></pre></td></tr></table></figure></p>
<p>When w = 1000000:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maximum cost to enter:  <span class="number">22.87</span></span><br></pre></td></tr></table></figure></p>
<p>Note that under the square-root utility function, the maximum cost to enter is higher, as utility diminished slower.</p>
<script type="math/tex; mode=display">\dfrac{dU^{sqrt}(w)}{dw} = \dfrac{1}{2\sqrt{w}} > \dfrac{1}{w}, \;when \;w\;is\;large</script><p><br><br><br></p>
<p>Reference:</p>
<ul>
<li>Wikipedia: <a href="https://en.wikipedia.org/wiki/St._Petersburg_paradox" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/St._Petersburg_paradox</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2019/03/generate-color-image/" class="prev">PREV</a><a href="/2019/02/portfolio-credit-risk-modeling/" class="next">NEXT</a></div><div id="container"></div><!-- link(rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css")--><link rel="stylesheet" href="/css/gitalk.css"><script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
    clientID: '4ec287ddd4ac34ff5087',
    clientSecret: 'ae45426765f12ac3e2f903662b8938dc4881f703',
    repo: 'jackliu234.github.io',
    owner: 'jackliu234',
    admin: ['jackliu234'],
    perPage: 100,
    id: 'Fri Feb 15 2019 00:00:00 GMT-0600 GMT'.split('GMT')[0].replace(/\s/g, '-'),
    distractionFreeMode: false,
    pagerDirection: 'first'
})

gitalk.render('container')</script><!-- block copyright--></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-133275176-1",'auto');ga('send','pageview');</script><link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" media="screen" type="text/css"><script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script><script>$(function(){$('.datatable').dataTable( {"order": [[ 0, "desc" ]],"iDisplayLength": -1,"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]} );});</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>